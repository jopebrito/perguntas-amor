<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1a0011">
    <title>500 Perguntas de Amor</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3EğŸ’•%3C/text%3E%3C/svg%3E">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="hearts-bg" class="hearts-background"></div>

    <!-- ===== WELCOME ===== -->
    <div id="screen-welcome" class="screen active">
        <div class="screen-inner centered">
            <div class="logo-hearts"><span class="hf">ğŸ’–</span><span class="hf d1">ğŸ’•</span><span class="hf d2">ğŸ’—</span></div>
            <h1 class="title-main">500 Perguntas<br><span class="title-script">de Amor</span></h1>
            <div class="couple-badge"><span class="name-jose">JosÃ©</span><span class="heart-beat">â¤ï¸</span><span class="name-rita">Rita</span></div>
            <p class="subtitle">Um jogo para nos conhecermos ainda melhor</p>
            <div class="countdown-mini" id="cd-welcome"></div>
            <button class="btn btn-primary btn-glow" onclick="App.go('login')">ComeÃ§ar</button>
        </div>
    </div>

    <!-- ===== LOGIN ===== -->
    <div id="screen-login" class="screen">
        <div class="screen-inner centered">
            <h2 class="section-title">Quem Ã©s tu?</h2>
            <p class="subtitle">Escolhe o teu perfil e entra com o teu PIN</p>
            <div class="login-grid">
                <button class="card-login" id="card-jose" onclick="App.selectUser('jose')">
                    <div class="card-emoji">ğŸ§”</div>
                    <div class="card-name">JosÃ©</div>
                </button>
                <button class="card-login" id="card-rita" onclick="App.selectUser('rita')">
                    <div class="card-emoji">ğŸ‘©</div>
                    <div class="card-name">Rita</div>
                </button>
            </div>
            <!-- PIN entry -->
            <div id="pin-area" class="pin-area" style="display:none">
                <p class="pin-label" id="pin-label">PIN do JosÃ©</p>
                <div class="pin-dots" id="pin-dots">
                    <span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span>
                </div>
                <div class="pin-pad">
                    <button class="pin-key" onclick="App.pinKey('1')">1</button>
                    <button class="pin-key" onclick="App.pinKey('2')">2</button>
                    <button class="pin-key" onclick="App.pinKey('3')">3</button>
                    <button class="pin-key" onclick="App.pinKey('4')">4</button>
                    <button class="pin-key" onclick="App.pinKey('5')">5</button>
                    <button class="pin-key" onclick="App.pinKey('6')">6</button>
                    <button class="pin-key" onclick="App.pinKey('7')">7</button>
                    <button class="pin-key" onclick="App.pinKey('8')">8</button>
                    <button class="pin-key" onclick="App.pinKey('9')">9</button>
                    <button class="pin-key" onclick="App.pinKey('clear')">âœ•</button>
                    <button class="pin-key" onclick="App.pinKey('0')">0</button>
                    <button class="pin-key pin-go" onclick="App.pinKey('go')">â†’</button>
                </div>
                <p class="pin-hint">Primeira vez? O PIN que escreveres fica como teu.</p>
            </div>
        </div>
    </div>

    <!-- ===== DASHBOARD ===== -->
    <div id="screen-dashboard" class="screen">
        <div class="screen-inner">
            <div class="dash-top">
                <div class="dash-user"><span id="dash-emoji"></span><span id="dash-name"></span></div>
                <button class="btn-icon" onclick="App.logout()" title="Sair">ğŸšª</button>
            </div>

            <div class="countdown-box">
                <div class="cd-label">Faltam para o Dia dos Namorados</div>
                <div class="cd-timer" id="cd-timer"></div>
            </div>

            <!-- Progress card -->
            <div class="progress-card">
                <div class="prog-ring-wrap">
                    <svg class="prog-ring" viewBox="0 0 120 120">
                        <circle class="prog-bg" cx="60" cy="60" r="52"/>
                        <circle class="prog-fill" id="prog-fill" cx="60" cy="60" r="52"/>
                    </svg>
                    <div class="prog-center"><span class="prog-num" id="prog-num">0</span><span class="prog-of">/500</span></div>
                </div>
                <div class="prog-info">
                    <h3 id="prog-title">Vamos comeÃ§ar!</h3>
                    <p id="prog-msg" class="prog-sub"></p>
                    <div class="prog-goal" id="prog-goal"></div>
                </div>
            </div>

            <!-- Phase 1: Answer -->
            <button class="btn btn-primary btn-block" id="btn-answer" onclick="App.continueAnswering()">
                <span id="btn-answer-text">ComeÃ§ar a responder</span><span class="arrow">â†’</span>
            </button>

            <!-- Phase 2: Guess (locked until both finish) -->
            <div class="guess-card" id="guess-card">
                <div class="guess-lock" id="guess-lock">
                    <span class="guess-icon">ğŸ”’</span>
                    <p class="guess-msg" id="guess-msg">Modo Adivinhar desbloqueia quando ambos terminarem as 500 perguntas</p>
                    <div class="guess-progress" id="guess-progress"></div>
                </div>
                <div class="guess-unlocked" id="guess-unlocked" style="display:none">
                    <span class="guess-icon">ğŸ¯</span>
                    <h3>Modo Adivinhar</h3>
                    <p>Tenta adivinhar o que o/a teu/tua parceiro/a respondeu!</p>
                    <button class="btn btn-primary" onclick="App.startGuess()">Jogar â†’</button>
                    <div class="guess-score" id="guess-score"></div>
                </div>
            </div>

            <h3 class="cat-heading">Categorias</h3>
            <div class="cat-grid" id="cat-grid"></div>

            <!-- Admin: Reset -->
            <details class="reset-details">
                <summary class="reset-summary">OpÃ§Ãµes avanÃ§adas</summary>
                <button class="btn btn-danger btn-block" onclick="App.resetConfirm()">
                    Apagar todas as minhas respostas
                </button>
            </details>
        </div>
    </div>

    <!-- ===== QUESTION (Answer mode) ===== -->
    <div id="screen-question" class="screen">
        <div class="screen-inner">
            <div class="q-top">
                <button class="btn-back" onclick="App.go('dashboard')">â† Voltar</button>
                <span class="q-badge" id="q-badge"></span>
                <span class="q-count" id="q-count"></span>
            </div>
            <div class="q-bar"><div class="q-bar-fill" id="q-bar-fill"></div></div>
            <div class="q-card" id="q-card">
                <div class="q-num" id="q-num"></div>
                <p class="q-text" id="q-text"></p>
            </div>
            <div class="q-answers" id="q-answers"></div>
            <div class="q-nav">
                <button class="btn btn-sm" id="btn-prev" onclick="App.prev()">â† Anterior</button>
                <button class="btn btn-sm" id="btn-skip" onclick="App.next()">Saltar â†’</button>
                <button class="btn btn-sm btn-accent" id="btn-next" onclick="App.next()" style="display:none">PrÃ³xima â†’</button>
            </div>
        </div>
    </div>

    <!-- ===== GUESS MODE (Family Feud) ===== -->
    <div id="screen-guess" class="screen">
        <div class="screen-inner">
            <div class="q-top">
                <button class="btn-back" onclick="App.go('dashboard')">â† Voltar</button>
                <span class="guess-badge">ğŸ¯ Modo Adivinhar</span>
                <span class="q-count" id="g-count"></span>
            </div>
            <div class="q-bar"><div class="q-bar-fill" id="g-bar-fill"></div></div>

            <div class="guess-prompt">
                <p id="g-partner-name">O que achas que a Rita respondeu?</p>
            </div>

            <div class="q-card" id="g-card">
                <div class="q-num" id="g-num"></div>
                <p class="q-text" id="g-text"></p>
            </div>

            <!-- Guess options -->
            <div class="q-answers" id="g-answers"></div>

            <!-- Reveal area (hidden until guess) -->
            <div class="reveal-area" id="reveal-area" style="display:none">
                <div class="reveal-card" id="reveal-card">
                    <div class="reveal-icon" id="reveal-icon"></div>
                    <div class="reveal-label" id="reveal-label"></div>
                    <div class="reveal-answer" id="reveal-answer"></div>
                </div>
                <button class="btn btn-primary" id="reveal-next" onclick="App.nextGuess()">PrÃ³xima â†’</button>
            </div>

            <!-- Score bar -->
            <div class="score-bar">
                <span class="score-correct" id="score-correct">âœ“ 0</span>
                <span class="score-wrong" id="score-wrong">âœ— 0</span>
            </div>
        </div>
    </div>

    <!-- ===== RESULTS ===== -->
    <div id="screen-results" class="screen">
        <div class="screen-inner">
            <div class="q-top">
                <button class="btn-back" onclick="App.go('dashboard')">â† Voltar</button>
                <h2 class="results-title">Resultados</h2>
                <span></span>
            </div>
            <div class="results-couple-card">
                <div class="rc-person"><span class="rc-emoji">ğŸ§”</span><span>JosÃ©</span><span class="rc-count" id="rc-jose">0/500</span></div>
                <div class="rc-heart">ğŸ’•</div>
                <div class="rc-person"><span class="rc-emoji">ğŸ‘©</span><span>Rita</span><span class="rc-count" id="rc-rita">0/500</span></div>
            </div>
            <div class="match-box" id="match-box" style="display:none">
                <div class="match-num" id="match-num">0%</div>
                <div class="match-label">Compatibilidade</div>
            </div>
            <div class="filter-row">
                <button class="fbtn active" data-f="all" onclick="App.filterResults('all')">Todas</button>
                <button class="fbtn" data-f="match" onclick="App.filterResults('match')">Iguais ğŸ’š</button>
                <button class="fbtn" data-f="diff" onclick="App.filterResults('diff')">Diferentes ğŸ’›</button>
            </div>
            <div class="results-list" id="results-list">
                <p class="empty-msg">Ambos precisam de responder para comparar! ğŸ’•</p>
            </div>
        </div>
    </div>

    <!-- Confirm modal -->
    <div id="modal" class="modal" style="display:none">
        <div class="modal-box">
            <p id="modal-msg"></p>
            <div class="modal-btns">
                <button class="btn btn-sm" onclick="App.modalClose()">Cancelar</button>
                <button class="btn btn-sm btn-danger-sm" id="modal-confirm" onclick="">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <!-- Loading -->
    <div id="loading" class="loading-overlay">
        <div class="loading-inner"><div class="spin-heart">ğŸ’–</div><p>A carregar...</p></div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="questions.js"></script>
    <script src="app.js"></script>
</body>
</html>
